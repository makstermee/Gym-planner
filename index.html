<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gym Planner Pro 2.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="appLoader">
        <div class="spinner"></div>
        <p>adowanie profilu...</p>
    </div>

    <div id="toastContainer"></div>

    <header class="top-nav">
        <div class="logo"><i class="fa-solid fa-dumbbell"></i> GymPlan</div>
        <div id="cloudStatus" class="cloud-status"><i class="fa-solid fa-cloud"></i></div>
    </header>

    <main id="mainContainer">
        
        <section id="view-auth" class="view active">
            <div class="auth-box">
                <h2>Witaj w formie! </h2>
                <p>Zaloguj si, aby synchronizowa treningi.</p>
                <form id="authForm">
                    <div class="input-group">
                        <i class="fa-solid fa-envelope"></i>
                        <input type="email" id="authEmail" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <i class="fa-solid fa-lock"></i>
                        <input type="password" id="authPass" placeholder="Haso (min. 6 znak贸w)" required>
                    </div>
                    <button type="submit" id="btnLogin" class="btn-primary">Zaloguj / Rejestruj</button>
                </form>
                <p id="authError" class="error-msg"></p>
            </div>
        </section>

        <section id="view-plans" class="view">
            <h2 class="section-title">Tw贸j Tydzie</h2>
            <div id="daysGrid" class="grid-container">
                </div>
        </section>

        <section id="view-editor" class="view">
            <div class="header-row">
                <button class="btn-icon" onclick="window.app.router('view-plans')"><i class="fa-solid fa-arrow-left"></i></button>
                <h2 id="editorTitle">Poniedziaek</h2>
                <button class="btn-icon" id="btnStartWorkout"><i class="fa-solid fa-play"></i></button>
            </div>
            
            <div class="add-exercise-box">
                <input type="text" id="newExName" placeholder="Nazwa wiczenia">
                <div class="row-inputs">
                    <input type="number" id="newExSets" placeholder="Serie" value="3">
                    <input type="number" id="newExReps" placeholder="Powt." value="10">
                    <button id="btnAddEx" class="btn-small"><i class="fa-solid fa-plus"></i></button>
                </div>
            </div>

            <div id="editorList" class="list-container"></div>
        </section>

        <section id="view-workout" class="view">
            <div class="workout-header">
                <div>
                    <small>Trening:</small>
                    <h2 id="workoutDayTitle">...</h2>
                </div>
                <div id="workoutTimer" class="timer-badge">00:00:00</div>
            </div>

            <div id="workoutList" class="list-container"></div>

            <button id="btnFinishWorkout" class="btn-danger big-btn">
                <i class="fa-solid fa-flag-checkered"></i> Zakocz Trening
            </button>
        </section>

        <section id="view-history" class="view">
            <h2 class="section-title">Historia Trening贸w</h2>
            <div id="historyList" class="list-container"></div>
        </section>

        <section id="view-profile" class="view">
            <h2 class="section-title">Tw贸j Profil</h2>
            <div class="card profile-card">
                <p>Zalogowany jako:</p>
                <strong id="userEmailDisplay">...</strong>
                <button id="btnLogout" class="btn-outline">Wyloguj si</button>
            </div>
            
            <div class="card chart-card">
                <canvas id="statsChart"></canvas>
            </div>
            <div style="text-align:center; margin-top:20px; color:#666; font-size:0.8rem;">
                Gym Planner Pro v2.0 (Optimized)
            </div>
        </section>

    </main>

    <nav class="bottom-nav" id="bottomNav">
        <button data-target="view-plans" class="active"><i class="fa-solid fa-calendar-days"></i><span>Plan</span></button>
        <button data-target="view-workout" id="navWorkoutBtn" style="display:none; color:var(--accent)"><i class="fa-solid fa-person-running"></i><span>Trening</span></button>
        <button data-target="view-history"><i class="fa-solid fa-clock-rotate-left"></i><span>Historia</span></button>
        <button data-target="view-profile"><i class="fa-solid fa-user"></i><span>Profil</span></button>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCacBxUhSiqaaCBrmVVKluMHMs3iMpR_cA",
            authDomain: "pro-plan-e6f00.firebaseapp.com",
            databaseURL: "https://pro-plan-e6f00-default-rtdb.europe-west1.firebasedabase.app",
            projectId: "pro-plan-e6f00",
            storageBucket: "pro-plan-e6f00.firebasestorage.app",
            messagingSenderId: "887703996706",
            appId: "1:887703996706:web:b7363c891b41b7d4697d7b",
            measurementId: "G-1WTB0NNLEB"
        };

        const app = initializeApp(firebaseConfig);
        window.auth = getAuth(app);
        window.db = getFirestore(app);
        window.isFirebaseReady = true;
    </script>
    <script type="module" src="app-v2.js"></script>
</body>
</html>
